import"../chunks/Bzak7iHL.js";import"../chunks/DQH0u__Z.js";import{c as rt,o as Ve,s as b,e as ve,f as ft,r as _t}from"../chunks/DCC44snd.js";import{p as qe,d as m,m as E,f as d,s as c,c as r,g as e,r as t,t as x,a as o,b as Ge,j as ke,k as re,u as i,aC as de,aG as ht,y as mt,z as xt,e as at,h as yt,$ as wt,n as bt}from"../chunks/CZIwaskW.js";import{i as f}from"../chunks/BQ6CF9gK.js";import{s as W}from"../chunks/CWrymlX0.js";import{i as Oe}from"../chunks/BRtZcoHD.js";import{a as Je,s as Ke}from"../chunks/5vQelUuP.js";import{g as Ze}from"../chunks/B156jpNp.js";import{u as st,i as kt}from"../chunks/lmZdkGOn.js";import{e as ot,i as it}from"../chunks/CFvJb8Nb.js";import{s as Ue}from"../chunks/F_QzQ3ly.js";import{p as nt}from"../chunks/Bp-8lCth.js";import{b as Ct}from"../chunks/C_VOYwi-.js";import{b as Mt}from"../chunks/DFZWBCUT.js";var jt=d('<div class="p-4 text-center"><svg class="animate-spin h-6 w-6 text-gray-400 mx-auto" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> <p class="text-sm text-gray-500 mt-2">Loading conversations...</p></div>'),zt=d('<div class="p-4 text-center"><svg class="h-8 w-8 text-red-400 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path></svg> <p class="text-sm text-red-600 mt-2"> </p> <button class="mt-2 text-sm text-blue-600 hover:text-blue-800">Try Again</button></div>'),St=d('<div class="p-4 text-center"><svg class="h-8 w-8 text-gray-400 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path></svg> <p class="text-sm text-gray-500 mt-2">No conversations yet</p> <p class="text-xs text-gray-400 mt-1">Start a conversation by booking gear or contacting an owner</p></div>'),Dt=d('<img class="h-10 w-10 rounded-full object-cover"/>'),$t=d('<div class="h-10 w-10 rounded-full bg-gray-300 flex items-center justify-center"><svg class="h-6 w-6 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg></div>'),Bt=d('<span class="inline-flex items-center justify-center px-2 py-1 text-xs font-bold leading-none text-white bg-red-600 rounded-full"> </span>'),Lt=d('<p class="text-xs text-gray-500"> </p>'),At=d('<img class="h-4 w-4 rounded object-cover mr-2"/>'),It=d("<span> </span>"),Tt=d('<div class="flex items-center mt-1"><!> <p class="text-xs text-gray-600 truncate"> </p> <!></div>'),Ut=d('<span class="text-gray-500">You:</span>'),Ht=d('<p class="text-sm text-gray-600 mt-1"><!> </p>'),Et=d('<p class="text-sm text-gray-400 mt-1 italic">No messages yet</p>'),Ft=d('<button type="button"><div class="flex items-start space-x-3"><div class="flex-shrink-0"><!></div> <div class="flex-1 min-w-0"><div class="flex items-center justify-between"><p class="text-sm font-medium text-gray-900 truncate"> </p> <div class="flex items-center space-x-2"><!> <!></div></div> <!> <!></div></div></button>'),Nt=d('<div class="divide-y divide-gray-200"></div>'),Rt=d('<div class="bg-white rounded-lg shadow-md h-full flex flex-col"><div class="p-4 border-b border-gray-200"><h2 class="text-lg font-semibold text-gray-900">Messages</h2></div> <div class="flex-1 overflow-y-auto"><!></div> <div class="p-4 border-t border-gray-200"><button class="w-full px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-green-500 disabled:opacity-50"> </button></div></div>');function et(Ce,ce){qe(ce,!1);const[Me,je]=Je(),k=()=>Ke(st,"$user",Me);let l=nt(ce,"selectedConversationId",12,null);const ae=rt();let w=E([]),L=E(!1),C=E(null);Ve(()=>{z()});async function z(){m(L,!0),m(C,null);try{const u=await fetch("/api/messages/conversations",{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});if(!u.ok)throw new Error("Failed to load conversations");const s=await u.json();m(w,s.conversations||[])}catch(u){console.error("Failed to load conversations:",u),m(C,u.message)}finally{m(L,!1)}}function F(u){l(u.id),ae("conversation-selected",u)}function N(u){const s=new Date(u),y=(new Date-s)/(1e3*60*60);return y<24?s.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):y<168?s.toLocaleDateString("en-US",{weekday:"short"}):s.toLocaleDateString("en-US",{month:"short",day:"numeric"})}function Q(u){if(!u)return"/placeholder-gear.jpg";const s=Array.isArray(u)?u:JSON.parse(u||"[]");return s.length>0?s[0]:"/placeholder-gear.jpg"}function ue(u,s=50){return u?u.length>s?u.substring(0,s)+"...":u:""}Oe();var ge=Rt(),pe=c(r(ge),2),ze=r(pe);{var M=u=>{var s=jt();o(u,s)},H=u=>{var s=ke(),g=re(s);{var y=Y=>{var O=zt(),$=c(r(O),2),B=r($,!0);t($);var I=c($,2);t(O),x(()=>b(B,e(C))),ve("click",I,z),o(Y,O)},D=Y=>{var O=ke(),$=re(O);{var B=V=>{var X=St();o(V,X)},I=V=>{var X=Nt();ot(X,5,()=>e(w),it,(Se,a)=>{var Z=Ft(),se=r(Z),ee=r(se),_e=r(ee);{var ye=p=>{var _=Dt();x(()=>{W(_,"src",(e(a),i(()=>e(a).other_participant_photo))),W(_,"alt",(e(a),i(()=>e(a).other_participant_name)))}),o(p,_)},De=p=>{var _=$t();o(p,_)};f(_e,p=>{e(a),i(()=>e(a).other_participant_photo)?p(ye):p(De,!1)})}t(ee);var oe=c(ee,2),T=r(oe),J=r(T),$e=r(J,!0);t(J);var we=c(J,2),S=r(we);{var n=p=>{var _=Bt(),j=r(_,!0);t(_),x(()=>b(j,(e(a),i(()=>e(a).unread_count)))),o(p,_)};f(S,p=>{e(a),i(()=>e(a).unread_count>0)&&p(n)})}var h=c(S,2);{var he=p=>{var _=Lt(),j=r(_,!0);t(_),x(K=>b(j,K),[()=>(e(a),i(()=>N(e(a).last_message_at)))]),o(p,_)};f(h,p=>{e(a),i(()=>e(a).last_message_at)&&p(he)})}t(we),t(T);var He=c(T,2);{var Fe=p=>{var _=Tt(),j=r(_);{var K=P=>{var q=At();x(Be=>{W(q,"src",Be),W(q,"alt",(e(a),i(()=>e(a).gear_title)))},[()=>(e(a),i(()=>Q(e(a).gear_images)))]),o(P,q)};f(j,P=>{e(a),i(()=>e(a).gear_images)&&P(K)})}var xe=c(j,2),te=r(xe,!0);t(xe);var v=c(xe,2);{var Ee=P=>{var q=It(),Be=r(q,!0);t(q),x(()=>{Ue(q,1,`ml-2 inline-flex items-center px-1.5 py-0.5 rounded-full text-xs font-medium ${e(a),i(()=>e(a).rental_status==="confirmed"?"bg-green-100 text-green-800":e(a).rental_status==="pending"?"bg-yellow-100 text-yellow-800":e(a).rental_status==="active"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800")??""}`),b(Be,(e(a),i(()=>e(a).rental_status)))}),o(P,q)};f(v,P=>{e(a),i(()=>e(a).rental_status)&&P(Ee)})}t(_),x(()=>b(te,(e(a),i(()=>e(a).gear_title)))),o(p,_)};f(He,p=>{e(a),i(()=>e(a).gear_title)&&p(Fe)})}var ie=c(He,2);{var ne=p=>{var _=Ht(),j=r(_);{var K=te=>{var v=Ut();o(te,v)};f(j,te=>{e(a),k(),i(()=>{var v;return e(a).last_message_sender_id===((v=k())==null?void 0:v.id)})&&te(K)})}var xe=c(j);t(_),x(te=>b(xe,` ${te??""}`),[()=>(e(a),i(()=>ue(e(a).last_message_content)))]),o(p,_)},me=p=>{var _=Et();o(p,_)};f(ie,p=>{e(a),i(()=>e(a).last_message_content)?p(ne):p(me,!1)})}t(oe),t(se),t(Z),x(()=>{Ue(Z,1,`w-full p-4 text-left hover:bg-gray-50 focus:outline-none focus:bg-gray-50 transition-colors ${de(l()),e(a),i(()=>l()===e(a).id?"bg-green-50 border-r-2 border-green-500":"")??""}`),b($e,(e(a),i(()=>e(a).other_participant_name)))}),ve("click",Z,()=>F(e(a))),o(Se,Z)}),t(X),o(V,X)};f($,V=>{e(w),i(()=>e(w).length===0)?V(B):V(I,!1)},!0)}o(Y,O)};f(g,Y=>{e(C)?Y(y):Y(D,!1)},!0)}o(u,s)};f(ze,u=>{e(L)?u(M):u(H,!1)})}t(pe);var A=c(pe,2),R=r(A),fe=r(R,!0);t(R),t(A),t(ge),x(()=>{R.disabled=e(L),b(fe,e(L)?"Refreshing...":"Refresh")}),ve("click",R,z),o(Ce,ge),Ge(),je()}var Yt=d('<div class="flex-1 flex items-center justify-center"><div class="text-center"><svg class="h-12 w-12 text-gray-400 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path></svg> <p class="text-lg text-gray-500 mt-4">Select a conversation to start messaging</p></div></div>'),Vt=d('<img class="h-10 w-10 rounded-full object-cover"/>'),qt=d('<div class="h-10 w-10 rounded-full bg-gray-300 flex items-center justify-center"><svg class="h-6 w-6 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg></div>'),Gt=d('<p class="text-sm text-gray-600"> </p>'),Ot=d('<div class="text-center py-8"><svg class="animate-spin h-6 w-6 text-gray-400 mx-auto" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> <p class="text-sm text-gray-500 mt-2">Loading messages...</p></div>'),Jt=d('<div class="text-center py-8"><svg class="h-8 w-8 text-red-400 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path></svg> <p class="text-sm text-red-600 mt-2"> </p> <button class="mt-2 text-sm text-blue-600 hover:text-blue-800">Try Again</button></div>'),Kt=d('<div class="text-center py-8"><svg class="h-8 w-8 text-gray-400 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path></svg> <p class="text-sm text-gray-500 mt-2">No messages yet</p> <p class="text-xs text-gray-400 mt-1">Start the conversation by sending a message below</p></div>'),Pt=d('<div class="flex justify-center"><span class="px-3 py-1 text-xs text-gray-500 bg-gray-100 rounded-full"> </span></div>'),Wt=d('<img class="h-6 w-6 rounded-full object-cover"/>'),Qt=d('<div class="h-6 w-6 rounded-full bg-gray-300 flex items-center justify-center"><svg class="h-4 w-4 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg></div>'),Xt=d('<div><!> <span class="text-xs text-gray-500"> </span> <span class="text-xs text-gray-400"> </span></div>'),Zt=d('<!> <div><div class="max-w-xs lg:max-w-md"><!> <div><p class="text-sm whitespace-pre-wrap"> </p></div></div></div>',1),er=d('<div class="mb-3 p-2 bg-red-50 border border-red-200 rounded text-sm text-red-600"> </div>'),tr=at('<svg class="animate-spin h-4 w-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>'),rr=at('<svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path></svg>'),ar=d('<div class="p-4 border-b border-gray-200"><div class="flex items-center space-x-3"><!> <div><h3 class="text-lg font-semibold text-gray-900"> </h3> <!></div></div></div> <div class="flex-1 overflow-y-auto p-4 space-y-4"><!></div> <div class="p-4 border-t border-gray-200"><!> <div class="flex space-x-2"><textarea placeholder="Type your message..." rows="1" class="flex-1 px-3 py-2 border border-gray-300 rounded-md resize-none focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500"></textarea> <button class="px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed"><!></button></div></div>',1),sr=d('<div class="bg-white rounded-lg shadow-md h-full flex flex-col"><!></div>');function tt(Ce,ce){qe(ce,!1);const[Me,je]=Je(),k=()=>Ke(st,"$user",Me);let l=nt(ce,"conversation",8,null);const ae=rt();let w=E([]),L=E(!1),C=E(null),z=E(""),F=E(!1),N=E();Ve(()=>{l()&&Q()}),ft(()=>{e(N)&&ht(N,e(N).scrollTop=e(N).scrollHeight)});async function Q(){if(l()){m(L,!0),m(C,null);try{const s=await fetch(`/api/messages/conversations/${l().id}`,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});if(!s.ok)throw new Error("Failed to load messages");const g=await s.json();m(w,g.messages||[])}catch(s){console.error("Failed to load messages:",s),m(C,s.message)}finally{m(L,!1)}}}async function ue(){if(!e(z).trim()||e(F)||!l())return;const s=e(z).trim();m(z,""),m(F,!0);try{const g=await fetch("/api/messages",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("auth_token")}`},body:JSON.stringify({conversation_id:l().id,content:s})});if(!g.ok)throw new Error("Failed to send message");const y=await g.json();m(w,[...e(w),y.message_data]),ae("message-sent",y.message_data)}catch(g){console.error("Failed to send message:",g),m(C,g.message),m(z,s)}finally{m(F,!1)}}function ge(s){s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),ue())}function pe(s){return new Date(s).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}function ze(s){const g=new Date(s),y=new Date,D=new Date(y);return D.setDate(D.getDate()-1),g.toDateString()===y.toDateString()?"Today":g.toDateString()===D.toDateString()?"Yesterday":g.toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})}function M(s,g){if(!g)return!0;const y=new Date(s.created_at).toDateString(),D=new Date(g.created_at).toDateString();return y!==D}function H(s,g){if(!g)return!1;const y=new Date(s.created_at)-new Date(g.created_at),D=300*1e3;return s.sender_id===g.sender_id&&y<D}mt(()=>de(l()),()=>{l()&&Q()}),xt(),Oe();var A=sr(),R=r(A);{var fe=s=>{var g=Yt();o(s,g)},u=s=>{var g=ar(),y=re(g),D=r(y),Y=r(D);{var O=n=>{var h=Vt();x(()=>{W(h,"src",(de(l()),i(()=>l().other_participant_photo))),W(h,"alt",(de(l()),i(()=>l().other_participant_name)))}),o(n,h)},$=n=>{var h=qt();o(n,h)};f(Y,n=>{de(l()),i(()=>l().other_participant_photo)?n(O):n($,!1)})}var B=c(Y,2),I=r(B),V=r(I,!0);t(I);var X=c(I,2);{var Se=n=>{var h=Gt(),he=r(h);t(h),x(()=>b(he,`About: ${de(l()),i(()=>l().gear_title)??""}`)),o(n,h)};f(X,n=>{de(l()),i(()=>l().gear_title)&&n(Se)})}t(B),t(D),t(y);var a=c(y,2),Z=r(a);{var se=n=>{var h=Ot();o(n,h)},ee=n=>{var h=ke(),he=re(h);{var He=ie=>{var ne=Jt(),me=c(r(ne),2),p=r(me,!0);t(me);var _=c(me,2);t(ne),x(()=>b(p,e(C))),ve("click",_,Q),o(ie,ne)},Fe=ie=>{var ne=ke(),me=re(ne);{var p=j=>{var K=Kt();o(j,K)},_=j=>{var K=ke(),xe=re(K);ot(xe,1,()=>e(w),it,(te,v,Ee)=>{var P=Zt(),q=re(P);{var Be=U=>{var le=Pt(),Le=r(le),Ye=r(Le,!0);t(Le),t(le),x(Ae=>b(Ye,Ae),[()=>(e(v),i(()=>ze(e(v).created_at)))]),o(U,le)};f(q,U=>{e(v),e(w),i(()=>M(e(v),e(w)[Ee-1]))&&U(Be)})}var Ne=c(q,2),Pe=r(Ne),We=r(Pe);{var lt=U=>{var le=Xt(),Le=r(le);{var Ye=Ie=>{var G=ke(),ut=re(G);{var gt=be=>{var Te=Wt();x(()=>{W(Te,"src",(e(v),i(()=>e(v).sender_photo))),W(Te,"alt",(e(v),i(()=>e(v).sender_name)))}),o(be,Te)},pt=be=>{var Te=Qt();o(be,Te)};f(ut,be=>{e(v),i(()=>e(v).sender_photo)?be(gt):be(pt,!1)})}o(Ie,G)};f(Le,Ie=>{e(v),k(),i(()=>{var G;return e(v).sender_id!==((G=k())==null?void 0:G.id)})&&Ie(Ye)})}var Ae=c(Le,2),vt=r(Ae,!0);t(Ae);var Xe=c(Ae,2),ct=r(Xe,!0);t(Xe),t(le),x(Ie=>{Ue(le,1,`flex items-center space-x-2 mb-1 ${e(v),k(),i(()=>{var G;return e(v).sender_id===((G=k())==null?void 0:G.id)?"justify-end":"justify-start"})??""}`),b(vt,(e(v),k(),i(()=>{var G;return e(v).sender_id===((G=k())==null?void 0:G.id)?"You":e(v).sender_name}))),b(ct,Ie)},[()=>(e(v),i(()=>pe(e(v).created_at)))]),o(U,le)};f(We,U=>{e(v),e(w),i(()=>!H(e(v),e(w)[Ee-1]))&&U(lt)})}var Re=c(We,2),Qe=r(Re),dt=r(Qe,!0);t(Qe),t(Re),t(Pe),t(Ne),x(()=>{Ue(Ne,1,`flex ${e(v),k(),i(()=>{var U;return e(v).sender_id===((U=k())==null?void 0:U.id)?"justify-end":"justify-start"})??""}`),Ue(Re,1,`px-4 py-2 rounded-lg ${e(v),k(),i(()=>{var U;return e(v).sender_id===((U=k())==null?void 0:U.id)?"bg-green-600 text-white":"bg-gray-100 text-gray-900"})??""}`),b(dt,(e(v),i(()=>e(v).content)))}),o(te,P)}),o(j,K)};f(me,j=>{e(w),i(()=>e(w).length===0)?j(p):j(_,!1)},!0)}o(ie,ne)};f(he,ie=>{e(C)?ie(He):ie(Fe,!1)},!0)}o(n,h)};f(Z,n=>{e(L)?n(se):n(ee,!1)})}t(a),Mt(a,n=>m(N,n),()=>e(N));var _e=c(a,2),ye=r(_e);{var De=n=>{var h=er(),he=r(h,!0);t(h),x(()=>b(he,e(C))),o(n,h)};f(ye,n=>{e(C)&&n(De)})}var oe=c(ye,2),T=r(oe);_t(T);var J=c(T,2),$e=r(J);{var we=n=>{var h=tr();o(n,h)},S=n=>{var h=rr();o(n,h)};f($e,n=>{e(F)?n(we):n(S,!1)})}t(J),t(oe),t(_e),x(n=>{b(V,(de(l()),i(()=>l().other_participant_name))),T.disabled=e(F),J.disabled=n},[()=>(e(z),e(F),i(()=>!e(z).trim()||e(F)))]),Ct(T,()=>e(z),n=>m(z,n)),ve("keypress",T,ge),ve("click",J,ue),o(s,g)};f(R,s=>{l()?s(u,!1):s(fe)})}t(A),o(Ce,A),Ge(),je()}var or=d('<meta name="description" content="Chat with gear owners and renters"/>'),ir=d('<div class="bg-white rounded-lg shadow-md p-8 text-center"><svg class="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path></svg> <h3 class="mt-2 text-lg font-medium text-gray-900">Sign In Required</h3> <p class="mt-1 text-gray-600">You need to be signed in to view your messages</p> <div class="mt-4"><button class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700">Sign In</button></div></div>'),nr=d('<div class="h-[600px]"><!></div>'),lr=d('<img class="h-8 w-8 rounded-full object-cover"/>'),dr=d('<div class="h-8 w-8 rounded-full bg-gray-300 flex items-center justify-center"><svg class="h-5 w-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg></div>'),vr=d('<p class="text-sm text-gray-600"> </p>'),cr=d('<div class="flex items-center space-x-3"><!> <div><h3 class="text-lg font-semibold text-gray-900"> </h3> <!></div></div>'),ur=d('<div class="h-[600px]"><div class="bg-white border-b border-gray-200 p-4 flex items-center space-x-3"><button class="p-2 rounded-md hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-green-500"><svg class="h-5 w-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg></button> <!></div> <div class="h-[calc(600px-80px)]"><!></div></div>'),gr=d('<div class="hidden md:block"><div class="grid grid-cols-1 lg:grid-cols-3 gap-6 h-[600px]"><div class="lg:col-span-1"><!></div> <div class="lg:col-span-2"><!></div></div></div> <div class="md:hidden"><!></div> <div class="mt-8 bg-blue-50 border border-blue-200 rounded-md p-4"><div class="flex"><svg class="h-5 w-5 text-blue-400" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg> <div class="ml-3"><h3 class="text-sm font-medium text-blue-800">How messaging works</h3> <div class="mt-2 text-sm text-blue-700"><ul class="list-disc list-inside space-y-1"><li>Conversations are automatically created when you book gear or receive a booking request</li> <li>You can message gear owners before booking to ask questions</li> <li>All messages are private and secure</li> <li>Be respectful and follow our community guidelines</li></ul></div></div></div></div>',1),pr=d('<div class="min-h-screen bg-gray-50"><div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"><div class="mb-8"><h1 class="text-3xl font-bold text-gray-900">Messages</h1> <p class="mt-2 text-gray-600">Chat with gear owners and renters about your bookings</p></div> <!></div></div>');function $r(Ce,ce){qe(ce,!1);const[Me,je]=Je(),k=()=>Ke(kt,"$isAuthenticated",Me);let l=E(null),ae=E(null),w=!1,L=E(!1);Ve(()=>{if(!k()){Ze("/auth/login?redirect="+encodeURIComponent("/messages"));return}return C(),window.addEventListener("resize",C),()=>{window.removeEventListener("resize",C)}});function C(){w=window.innerWidth<768}function z(M){m(l,M.detail),m(ae,e(l).id),w&&m(L,!0)}function F(){m(L,!1),m(l,null),m(ae,null)}function N(M){console.log("Message sent:",M.detail)}Oe();var Q=pr();yt(M=>{var H=or();wt.title="Messages - GearGrab",o(M,H)});var ue=r(Q),ge=c(r(ue),2);{var pe=M=>{var H=ir(),A=c(r(H),6),R=r(A);t(A),t(H),ve("click",R,()=>Ze("/auth/login?redirect="+encodeURIComponent("/messages"))),o(M,H)},ze=M=>{var H=gr(),A=re(H),R=r(A),fe=r(R),u=r(fe);et(u,{get selectedConversationId(){return e(ae)},$$events:{"conversation-selected":z}}),t(fe);var s=c(fe,2),g=r(s);tt(g,{get conversation(){return e(l)},$$events:{"message-sent":N}}),t(s),t(R),t(A);var y=c(A,2),D=r(y);{var Y=$=>{var B=nr(),I=r(B);et(I,{get selectedConversationId(){return e(ae)},$$events:{"conversation-selected":z}}),t(B),o($,B)},O=$=>{var B=ur(),I=r(B),V=r(I),X=c(V,2);{var Se=se=>{var ee=cr(),_e=r(ee);{var ye=S=>{var n=lr();x(()=>{W(n,"src",(e(l),i(()=>e(l).other_participant_photo))),W(n,"alt",(e(l),i(()=>e(l).other_participant_name)))}),o(S,n)},De=S=>{var n=dr();o(S,n)};f(_e,S=>{e(l),i(()=>e(l).other_participant_photo)?S(ye):S(De,!1)})}var oe=c(_e,2),T=r(oe),J=r(T,!0);t(T);var $e=c(T,2);{var we=S=>{var n=vr(),h=r(n,!0);t(n),x(()=>b(h,(e(l),i(()=>e(l).gear_title)))),o(S,n)};f($e,S=>{e(l),i(()=>e(l).gear_title)&&S(we)})}t(oe),t(ee),x(()=>b(J,(e(l),i(()=>e(l).other_participant_name)))),o(se,ee)};f(X,se=>{e(l)&&se(Se)})}t(I);var a=c(I,2),Z=r(a);tt(Z,{get conversation(){return e(l)},$$events:{"message-sent":N}}),t(a),t(B),ve("click",V,F),o($,B)};f(D,$=>{e(L)?$(O,!1):$(Y)})}t(y),bt(2),o(M,H)};f(ge,M=>{k()?M(ze,!1):M(pe)})}t(ue),t(Q),o(Ce,Q),Ge(),je()}export{$r as component};
