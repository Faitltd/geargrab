const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./CNCHNrcA.js","./Bj253pq-.js"])))=>i.map(i=>d[i]);
import{_ as d}from"./Dp1pzeXC.js";var l={};const m=l.VITE_API_URL||"http://localhost:3001/api";let s=null;typeof window<"u"&&d(async()=>{const{auth:e}=await import("./Bj253pq-.js").then(t=>t.d);return{auth:e}},[],import.meta.url).then(({auth:e})=>{s=e}).catch(console.error);async function r(e,t={}){const a=`${m}${e}`;let n=null;if(typeof window<"u"){if(s!=null&&s.currentUser)try{n=await s.currentUser.getIdToken()}catch(o){console.warn("Failed to get Firebase token:",o)}n||(n=localStorage.getItem("auth_token"))}const c={headers:{"Content-Type":"application/json",...n&&{Authorization:`Bearer ${n}`},...t.headers},...t};c.body&&typeof c.body=="object"&&(c.body=JSON.stringify(c.body));try{const o=await fetch(a,c);if(o.status===401)throw typeof window<"u"&&localStorage.removeItem("auth_token"),new Error("Authentication required");if(!o.ok){const u=await o.json().catch(()=>({}));throw new Error(u.message||`API call failed: ${o.status} ${o.statusText}`)}return await o.json()}catch(o){throw console.error(`API call to ${e} failed:`,o),o}}function i(e){const t=`/${e.toLowerCase()}s`;return{async list(a="-created_at"){const n=new URLSearchParams;return a&&n.set("order",a),r(`${t}?${n.toString()}`)},async filter(a,n="-created_at"){return r(`${t}/search`,{method:"POST",body:{filter:a,order:n}})},async get(a){return r(`${t}/${a}`)},async create(a){return r(t,{method:"POST",body:a})},async update(a,n){return r(`${t}/${a}`,{method:"PUT",body:n})},async delete(a){return r(`${t}/${a}`,{method:"DELETE"})}}}const h={entities:{GearItem:i("gear_item"),User:i("user"),Rental:i("rental"),Message:i("message"),GuaranteeClaim:i("guarantee_claim"),CartItem:i("cart_item"),TransactionRecord:i("transaction_record"),TaxDocument:i("tax_document"),Review:i("review"),Notification:i("notification")},auth:{async me(){return r("/auth/me")},async login(e){const t=await r("/auth/login",{method:"POST",body:e});return t.token&&typeof window<"u"&&localStorage.setItem("auth_token",t.token),t},async loginWithFirebase(e){const t=await r("/auth/firebase",{method:"POST",body:{idToken:e}});return t.token&&typeof window<"u"&&localStorage.setItem("auth_token",t.token),t},async logout(){if(typeof window<"u"&&localStorage.removeItem("auth_token"),s)try{const{signOut:e}=await d(async()=>{const{signOut:t}=await import("./CNCHNrcA.js");return{signOut:t}},__vite__mapDeps([0,1]),import.meta.url);await e()}catch(e){console.warn("Firebase signout failed:",e)}return r("/auth/logout",{method:"POST"})},async isAuthenticated(){if(s!=null&&s.currentUser)return!0;try{return await this.me(),!0}catch{return!1}},async register(e){return r("/auth/register",{method:"POST",body:e})}},integrations:{Core:{async UploadFile({file:e}){const t=new FormData;return t.append("file",e),r("/upload",{method:"POST",body:t,headers:{}})},async SendEmail(e){return r("/integrations/send-email",{method:"POST",body:e})},async InvokeLLM(e){return r("/integrations/llm",{method:"POST",body:e})},async GenerateImage(e){return r("/integrations/generate-image",{method:"POST",body:e})},async ExtractDataFromUploadedFile(e){return r("/integrations/extract-data",{method:"POST",body:e})}}}};export{h as b};
